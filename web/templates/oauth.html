{{define "content"}}
<div class="max-w-2xl mx-auto">
    <div class="page-header">
        <h1>Connect Google Calendar</h1>
        <p>Authorize SchedLock to access your Google Calendar</p>
    </div>

    {{if .Error}}
    <div class="alert alert-error mb-6">
        <strong>Error:</strong> {{.Error}}
    </div>
    {{end}}

    <div class="card">
        <div class="card-body">
            <div class="steps">
                <!-- Step 1 -->
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>Authorization</h3>
                        <p>Click the button below to open Google's authorization page in a new tab.</p>
                        <a href="{{.AuthURL}}" target="_blank" rel="noopener" class="btn btn-primary">
                            Open Google Authorization
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 16px; height: 16px;">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25" />
                            </svg>
                        </a>
                    </div>
                </div>

                <!-- Step 2 -->
                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>Sign In and Authorize</h3>
                        <p>Sign in with your Google account and grant SchedLock permission to manage your calendar events.</p>
                    </div>
                </div>

                <!-- Step 3 -->
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>Copy the Authorization Code</h3>
                        <p>After authorizing, Google will display an authorization code. Copy it to your clipboard.</p>
                    </div>
                </div>

                <!-- Step 4 -->
                <div class="step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h3>Enter the Code</h3>
                        <p>Paste the authorization code below to complete the connection.</p>
                        <form action="/oauth/callback" method="POST" class="mt-4">
                            <input type="hidden" name="csrf_token" value="{{.CSRFToken}}">
                            <input type="hidden" name="state" value="{{.State}}">
                            <div style="display: flex; gap: var(--space-3); flex-wrap: wrap;">
                                <input type="text" name="code" 
                                       placeholder="Paste authorization code here"
                                       class="form-input" 
                                       style="flex: 1; min-width: 250px;"
                                       required>
                                <button type="submit" class="btn btn-success">
                                    Connect Account
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            {{if .Instructions}}
            <div class="mt-8 pt-6 border-t">
                <h4 style="font-family: var(--font-serif); margin-bottom: var(--space-3);">Additional Instructions</h4>
                <div class="text-sm" style="color: var(--text-secondary);">
                    {{range .Instructions}}
                    <p>{{.}}</p>
                    {{end}}
                </div>
            </div>
            {{end}}
        </div>
    </div>

    <div class="mt-6" style="text-align: center;">
        <a href="/settings" class="btn btn-ghost btn-sm">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 16px; height: 16px;">
                <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18" />
            </svg>
            Back to Settings
        </a>
    </div>
</div>
{{end}}

{{template "layout" .}}
