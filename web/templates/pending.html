{{define "content"}}
<div class="page-header">
    <h1>Pending Approvals</h1>
    <p>Review and approve calendar operation requests</p>
</div>

{{if .Requests}}
<div class="card animate-fade-in-scale table-mobile-cards">
    <!-- Desktop table view -->
    <div class="table-container">
        <table class="table">
            <thead>
                <tr>
                    <th>Request</th>
                    <th>Operation</th>
                    <th>Created</th>
                    <th>Expires</th>
                    <th style="text-align: right;">Actions</th>
                </tr>
            </thead>
            <tbody>
                {{range .Requests}}
                <tr>
                    <td>
                        <a href="/requests/{{.ID}}">{{.ID}}</a>
                    </td>
                    <td>
                        <span class="badge badge-primary">
                            {{if eq .Operation "create_event"}}Create Event
                            {{else if eq .Operation "update_event"}}Update Event
                            {{else if eq .Operation "delete_event"}}Delete Event
                            {{else}}{{.Operation}}{{end}}
                        </span>
                    </td>
                    <td>{{formatTime .CreatedAt}}</td>
                    <td>{{formatTime .ExpiresAt}}</td>
                    <td style="text-align: right;">
                        <div style="display: inline-flex; gap: var(--space-2);">
                            <form action="/requests/{{.ID}}/approve" method="POST" style="display: inline;"
                                  hx-post="/requests/{{.ID}}/approve" hx-swap="none">
                                <input type="hidden" name="csrf_token" value="{{$.CSRFToken}}">
                                <button type="submit" class="btn btn-success btn-sm">Approve</button>
                            </form>
                            <form action="/requests/{{.ID}}/deny" method="POST" style="display: inline;"
                                  hx-post="/requests/{{.ID}}/deny" hx-swap="none">
                                <input type="hidden" name="csrf_token" value="{{$.CSRFToken}}">
                                <button type="submit" class="btn btn-danger btn-sm">Deny</button>
                            </form>
                            <a href="/requests/{{.ID}}" class="btn btn-secondary btn-sm">Details</a>
                        </div>
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>

    <!-- Mobile card view -->
    <div class="mobile-cards">
        {{range .Requests}}
        <div class="mobile-card">
            <div class="mobile-card-header">
                <a href="/requests/{{.ID}}" class="mobile-card-id">{{.ID}}</a>
                <span class="badge badge-primary">
                    {{if eq .Operation "create_event"}}Create Event
                    {{else if eq .Operation "update_event"}}Update Event
                    {{else if eq .Operation "delete_event"}}Delete Event
                    {{else}}{{.Operation}}{{end}}
                </span>
            </div>
            <div class="mobile-card-meta">
                <div class="mobile-card-meta-row">
                    <span class="mobile-card-meta-label">Created</span>
                    <span>{{formatTime .CreatedAt}}</span>
                </div>
                <div class="mobile-card-meta-row">
                    <span class="mobile-card-meta-label">Expires</span>
                    <span>{{formatTime .ExpiresAt}}</span>
                </div>
            </div>
            <div class="mobile-card-actions">
                <form action="/requests/{{.ID}}/approve" method="POST"
                      hx-post="/requests/{{.ID}}/approve" hx-swap="none">
                    <input type="hidden" name="csrf_token" value="{{$.CSRFToken}}">
                    <button type="submit" class="btn btn-success btn-sm">Approve</button>
                </form>
                <form action="/requests/{{.ID}}/deny" method="POST"
                      hx-post="/requests/{{.ID}}/deny" hx-swap="none">
                    <input type="hidden" name="csrf_token" value="{{$.CSRFToken}}">
                    <button type="submit" class="btn btn-danger btn-sm">Deny</button>
                </form>
                <a href="/requests/{{.ID}}" class="btn btn-secondary btn-sm">Details</a>
            </div>
        </div>
        {{end}}
    </div>
</div>
{{else}}
<div class="empty-state animate-fade-in">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" class="empty-state-icon">
        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
    </svg>
    <h3>All Caught Up</h3>
    <p>No pending approval requests. Your calendar operations are up to date.</p>
</div>
{{end}}
{{end}}

{{template "layout" .}}
