{{define "content"}}
<div class="page-header">
    <h1>Dashboard</h1>
    <p>Overview of your calendar approval system</p>
</div>

<!-- Stats Grid -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-label">Pending Approval</div>
        <div class="stat-value">{{.PendingCount}}</div>
        <div class="stat-meta">Active requests awaiting your decision</div>
        <a href="/pending" class="stat-link">
            View all
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
            </svg>
        </a>
    </div>

    <div class="stat-card">
        <div class="stat-label">Today's Requests</div>
        <div class="stat-value">{{if .Stats}}{{.Stats.TotalToday}}{{else}}0{{end}}</div>
        <div class="stat-meta">Requests processed today</div>
        <a href="/history" class="stat-link">
            View history
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
            </svg>
        </a>
    </div>

    <div class="stat-card">
        <div class="stat-label">Active API Keys</div>
        <div class="stat-value">{{.APIKeyTotal}}</div>
        <div class="stat-meta">Keys with access to the API</div>
        <a href="/apikeys" class="stat-link">
            Manage keys
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
            </svg>
        </a>
    </div>

    <div class="stat-card">
        <div class="stat-label">Configuration</div>
        <div class="stat-value" style="font-size: var(--text-2xl);">Settings</div>
        <div class="stat-meta">System and notification config</div>
        <a href="/settings" class="stat-link">
            Open settings
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
            </svg>
        </a>
    </div>
</div>

<!-- Pending Requests -->
{{if .PendingRequests}}
<div class="card animate-fade-in-scale">
    <div class="card-header">
        <h3>Pending Approvals</h3>
        <p>Calendar operations awaiting your review</p>
    </div>
    <div class="list-group" style="border: none; border-top: 1px solid var(--border-subtle); border-radius: 0;">
        {{range .PendingRequests}}
        <div class="list-item">
            <div class="list-item-content">
                <div style="display: flex; align-items: center; gap: var(--space-2); margin-bottom: var(--space-2); flex-wrap: wrap;">
                    <span class="badge badge-primary">{{.Operation}}</span>
                    <span class="badge badge-default">{{.Status}}</span>
                </div>
                <div class="list-item-meta">
                    Created {{formatTime .CreatedAt}} &middot; Expires {{formatTime .ExpiresAt}}
                </div>
            </div>
            <div class="list-item-actions">
                <form action="/requests/{{.ID}}/approve" method="POST" style="display: inline;">
                    <input type="hidden" name="csrf_token" value="{{$.CSRFToken}}">
                    <button type="submit" class="btn btn-success btn-sm">Approve</button>
                </form>
                <form action="/requests/{{.ID}}/deny" method="POST" style="display: inline;">
                    <input type="hidden" name="csrf_token" value="{{$.CSRFToken}}">
                    <button type="submit" class="btn btn-danger btn-sm">Deny</button>
                </form>
                <a href="/requests/{{.ID}}" class="btn btn-secondary btn-sm">Details</a>
            </div>
        </div>
        {{end}}
    </div>
</div>
{{else}}
<div class="empty-state animate-fade-in">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" class="empty-state-icon">
        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
    </svg>
    <h3>All Caught Up</h3>
    <p>No pending approval requests. Your calendar operations are up to date.</p>
</div>
{{end}}
{{end}}

{{template "layout" .}}
